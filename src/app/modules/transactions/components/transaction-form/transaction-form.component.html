<div class="form-container">
  <div class="form-card">
    <h2>{{ isEditMode ? 'Modifier la transaction' : 'Nouvelle transaction' }}</h2>

    <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="type">Type</label>
        <select
          id="type"
          class="form-control"
          [class.is-invalid]="submitted && f['type'].errors"
          formControlName="type"
        >
          <option value="expense">Dépense</option>
          <option value="income">Revenu</option>
        </select>
      </div>

      <div class="form-group">
        <label for="category">Catégorie</label>
        <select
          id="category"
          class="form-control"
          [class.is-invalid]="submitted && f['category'].errors"
          formControlName="category"
        >
          <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="amount">Montant (TND)</label>
        <input
          type="number"
          id="amount"
          class="form-control"
          [class.is-invalid]="submitted && f['amount'].errors"
          formControlName="amount"
          step="0.01"
          min="0"
          placeholder="0.00"
        />
        <div class="invalid-feedback" *ngIf="submitted && f['amount'].errors">
          <small *ngIf="f['amount'].errors['required']">Le montant est requis</small>
          <small *ngIf="f['amount'].errors['min']">Le montant doit être positif</small>
        </div>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <input
          type="text"
          id="description"
          class="form-control"
          [class.is-invalid]="submitted && f['description'].errors"
          formControlName="description"
          placeholder="Description de la transaction"
        />
        <div class="invalid-feedback" *ngIf="submitted && f['description'].errors">
          <small *ngIf="f['description'].errors['required']">La description est requise</small>
          <small *ngIf="f['description'].errors['minlength']">Min 3 caractères</small>
        </div>
      </div>

      <div class="form-group">
        <label for="date">Date</label>
        <input
          type="date"
          id="date"
          class="form-control"
          [class.is-invalid]="submitted && f['date'].errors"
          formControlName="date"
        />
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="loading">
          {{ loading ? 'En cours...' : 'Enregistrer' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="router.navigate(['/transactions'])">
          Annuler
        </button>
      </div>
    </form>
  </div>
</div>
